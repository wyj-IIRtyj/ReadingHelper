(function(){
'use strict';var PMb=function(a){return PENPOT.Mv(function(b){var c=new Image;PENPOT.wu(c,"onload",function(){b.next(c);return b.complete()});PENPOT.wu(c,"crossOrigin","anonymous");PENPOT.wu(c,"onerror",function(d){return b.error(d)});PENPOT.wu(c,"onabort",function(){return b.error(PENPOT.ih("operation aborted",PENPOT.Ph.d_(PENPOT.t([new PENPOT.k(null,3,[PENPOT.Sh,PENPOT.OUa,PENPOT.on,PENPOT.PUa,PENPOT.Bq,"operation aborted"],null),null])),null))});PENPOT.wu(c,"src",a);return function(){PENPOT.wu(c,
"src","");PENPOT.wu(c,"onload",null);PENPOT.wu(c,"onerror",null);return PENPOT.wu(c,"onabort",null)}})},QMb=function(a,b,c){var d=a/b;return a<b?new PENPOT.A(null,2,5,PENPOT.D,[c,1/d*c],null):new PENPOT.A(null,2,5,PENPOT.D,[c*d,c],null)},SMb=function(a){if(PENPOT.m(RMb.has(a))){var b=RMb.get(a);return PENPOT.Ov(b.text())}return PENPOT.$v(function(c){return c==null?(0,PENPOT.Aw)(a):PENPOT.cw(function(d){return RMb.set(a,PENPOT.TUa(d,"text/plain"))},PENPOT.$v(PENPOT.SUa,(0,PENPOT.Aw)(PENPOT.Ej.b_(c))))},
PENPOT.bw(function(c){if(PENPOT.qu("app.rasterizer",PENPOT.kk)){var d=function(){return new PENPOT.Tg(function(){return new PENPOT.A(null,1,5,PENPOT.D,[new PENPOT.A(null,2,5,PENPOT.D,[PENPOT.Bq,"fetching data uri"],null)],null)})}(),e=PENPOT.su();PENPOT.nu(function(){var f=PENPOT.Rb(d),h=PENPOT.Mf.a_(PENPOT.XB,f);f=PENPOT.Xu.b_(PENPOT.Ph.d_(PENPOT.t([null,null])));var l=new PENPOT.k(null,7,[PENPOT.ND,f,PENPOT.OD,e,PENPOT.PD,h,PENPOT.QD,PENPOT.Nn(),PENPOT.RD,new PENPOT.Tg(function(){return PENPOT.ru(h)}),
PENPOT.SD,"app.rasterizer",PENPOT.TD,PENPOT.kk],null);f=function(){return c!=null?PENPOT.y.d_(l,PENPOT.UD,c,PENPOT.t([PENPOT.a4a,new PENPOT.Tg(function(){return c.stack})])):l}();return PENPOT.Wg.a_(PENPOT.VD,PENPOT.Ke(f))})}return(0,PENPOT.Aw)(null)},PENPOT.Gw(new PENPOT.k(null,5,[PENPOT.Bw,a,PENPOT.Fw,PENPOT.JE,PENPOT.ol,PENPOT.bB,PENPOT.Es,PENPOT.EVa,PENPOT.FVa,!0],null))))},TMb=function(a){var b=PENPOT.rw(a,"href");return PENPOT.m(b)?PENPOT.Ai(b,"data:")?(0,PENPOT.Aw)(a):PENPOT.Yv(function(c){PENPOT.uw(a,
"href",c);return a},SMb(b)):PENPOT.Pv()},UMb=function(a,b){var c=a.documentElement;var d=a.createElementNS("http://www.w3.org/2000/svg","style");PENPOT.sw(d,a.createTextNode(b));return PENPOT.sw(c,d)},VMb=function(a){return PENPOT.aw(function(b,c){var d=PENPOT.v(c,0,null);c=PENPOT.v(c,1,null);return PENPOT.Fi(b,d,c)},a,PENPOT.$v(function(b){return PENPOT.Yv(function(c){return new PENPOT.A(null,2,5,PENPOT.D,[b,c],null)},SMb(b))},PENPOT.Yv(PENPOT.Nc,PENPOT.Ov(PENPOT.Fg(/url\((https?:\/\/[^)]+)\)/,a)))))},
WMb=function(a){return PENPOT.dw(PENPOT.$v(function(b){var c=PENPOT.rw(b,"style");return PENPOT.cw(function(d){return PENPOT.uw(b,"style",d)},VMb(c))},PENPOT.Ov(PENPOT.qVa(a,"[style]"))))},XMb=function(a){return PENPOT.dw(PENPOT.$v(function(b){return PENPOT.cw(function(c){return PENPOT.sVa(b,c)},VMb(PENPOT.rVa(b)))},PENPOT.Ov(PENPOT.qVa(a,"style"))))},YMb=function(a,b){return PENPOT.Rv(PENPOT.dw(PENPOT.$v(TMb,PENPOT.Ov(PENPOT.qVa(a,"image")))),PENPOT.dw(PENPOT.cw(PENPOT.Le(UMb,a),VMb(b))),WMb(a),
XMb(a),(0,PENPOT.Aw)(a))},ZMb=function(a){return(new DOMParser).parseFromString(a,"image/svg+xml")},$Mb=function(a){a=a.documentElement;return(new XMLSerializer).serializeToString(a)},aNb=function(a,b,c){a=ZMb(a);return PENPOT.Yv($Mb,PENPOT.Yv(function(d){var e=d.documentElement;var f=d.documentElement;var h=PENPOT.rw(f,"width");f=PENPOT.rw(f,"height");PENPOT.oj(h,f)?(f=d.documentElement,h=PENPOT.rw(f,"width"),f=PENPOT.rw(f,"height"),h=QMb(PENPOT.mj(h,0),PENPOT.mj(f,0),c)):(h=PENPOT.rw(d.documentElement,
"viewBox"),typeof h==="string"?(f=PENPOT.Gi(h,/\s+/),PENPOT.v(f,0,null),PENPOT.v(f,1,null),h=PENPOT.v(f,2,null),f=PENPOT.v(f,3,null),h=QMb(PENPOT.mj(h,0),PENPOT.mj(f,0),c)):h=null);f=h;h=PENPOT.v(f,0,null);f=PENPOT.v(f,1,null);PENPOT.uw(e,"width",""+(h??""));PENPOT.uw(e,"height",""+(f??""));return d},YMb(a,b)))},bNb=function(a){return PENPOT.Mv(function(b){var c=PENPOT.KB.createElement("canvas");c.width=a.width;c.height=a.height;c.getContext("bitmaprenderer").transferFromImageBitmap(a);c.toBlob(function(d){b.next(d);
return b.complete()});return PENPOT.Ke(null)})},cNb=function(a){var b=a.data,c=a.styles,d=PENPOT.yq.a_(a.width,300),e=PENPOT.yq.a_(a.quality,"medium");return PENPOT.$v(function(f){return PENPOT.cw(function(){return PENPOT.UUa(f)},PENPOT.$v(function(h){var l={resizeWidth:d,resizeQuality:e};var n=h.width;var u=h.height;if("OffscreenCanvas"in window)n=new OffscreenCanvas(n,u);else{var z=document.createElement("canvas");PENPOT.wu(z,"width",n);PENPOT.wu(z,"height",u);n=z}n.getContext("2d").drawImage(h,
0,0);return createImageBitmap(n,l)},PMb(f)))},PENPOT.Yv(PENPOT.VUa,PENPOT.Yv(function(f){return PENPOT.TUa(f,"image/svg+xml")},aNb(b,c,d))))},gNb=function(a){var b=a.data;if(PENPOT.Ai(dNb,a.origin)){var c=b.id;a=b.payload;b=b.scope;if(a!=null&&PENPOT.r.a_(b,"penpot/rasterizer")){b=PENPOT.Le(eNb,c);c=PENPOT.Le(fNb,c);a:switch(PENPOT.yq.a_(a.result,"blob")){case "image-bitmap":a=cNb(a);break a;default:a=PENPOT.$v(bNb,cNb(a))}a=PENPOT.DUa(a,b,c)}else a=null;return a}return null},hNb=function(a,b,c){a=
{id:a,type:b,scope:"penpot/rasterizer",payload:c};return window===parent?null:c instanceof ImageBitmap?parent.postMessage(a,dNb,[c]):parent.postMessage(a,dNb)},eNb=function(a,b){return hNb(a,"success",b)},fNb=function(a,b){return hNb(a,"failure",PENPOT.lh(b))},jNb=function(){window.addEventListener("message",gNb);hNb(null,"ready",null);if(PENPOT.qu("app.rasterizer",PENPOT.Bj)){var a=function(){return new PENPOT.Tg(function(){return new PENPOT.A(null,3,5,PENPOT.D,[new PENPOT.A(null,2,5,PENPOT.D,[PENPOT.Bq,
"initialized"],null),new PENPOT.A(null,2,5,PENPOT.D,[PENPOT.Hzb,""+(PENPOT.Au??"")],null),new PENPOT.A(null,2,5,PENPOT.D,[iNb,""+(dNb??"")],null)],null)})}(),b=PENPOT.su();PENPOT.nu(function(){var c=PENPOT.Rb(a),d=PENPOT.Mf.a_(PENPOT.XB,c);c=PENPOT.Xu.b_(PENPOT.Ph.d_(PENPOT.t([null,null])));c=new PENPOT.k(null,7,[PENPOT.ND,c,PENPOT.OD,b,PENPOT.PD,d,PENPOT.QD,PENPOT.Nn(),PENPOT.RD,new PENPOT.Tg(function(){return PENPOT.ru(d)}),PENPOT.SD,"app.rasterizer",PENPOT.TD,PENPOT.Bj],null);return PENPOT.Wg.a_(PENPOT.VD,
PENPOT.Ke(c))})}return null},iNb=new PENPOT.x(null,"parent-uri","parent-uri",-371819908);PENPOT.Ra("rasterizer");PENPOT.pu.set("app.rasterizer",PENPOT.ou(PENPOT.Bj));var RMb=new Map,dNb=""+(PENPOT.Au??"");PENPOT.na("app.rasterizer.init",jNb);PENPOT.cb();jNb();
}).call(this);
//# sourceMappingURL=rasterizer.e0fb112bf-1756299390.js.map
